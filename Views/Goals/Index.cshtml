@model List<GoalTrackerApp.Models.Goal>
@{
    ViewBag.Title = "Goals List";
}

<div class="page-header">
    <div>
        <h2><i class="fas fa-trophy"></i> My Goals</h2>
        <p class="text-muted mb-0">Track and manage your short-term and long-term goals</p>
    </div>
    <a class="btn btn-primary" href="/Goals/Create">
        <i class="fas fa-plus"></i> Add New Goal
    </a>
</div>

<div class="filter-section">
    <form method="get" class="row g-3 align-items-end">
        <div class="col-md-4">
            <label><i class="fas fa-filter"></i> Filter by Type</label>
            <select name="type" class="form-select">
                <option value="">All Types</option>
                <option value="ShortTerm">Short Term</option>
                <option value="LongTerm">Long Term</option>
            </select>
        </div>
        <div class="col-md-4">
            <label><i class="fas fa-check-circle"></i> Filter by Status</label>
            <select name="status" class="form-select">
                <option value="">All Statuses</option>
                <option value="Active">Active</option>
                <option value="Completed">Completed</option>
            </select>
        </div>
        <div class="col-md-4">
            <button type="submit" class="btn btn-outline-secondary w-100">
                <i class="fas fa-search"></i> Apply Filters
            </button>
        </div>
    </form>
</div>

<div class="goal-card">
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th><i class="fas fa-heading"></i> Title</th>
                    <th><i class="fas fa-tag"></i> Type</th>
                    <th><i class="fas fa-chart-line"></i> Progress</th>
                    <th><i class="fas fa-info-circle"></i> Status</th>
                    <th><i class="fas fa-calendar"></i> Target Date</th>
                    <th><i class="fas fa-cogs"></i> Actions</th>
                </tr>
            </thead>
            <tbody>
                @if(Model.Count == 0)
                {
                    <tr>
                        <td colspan="6" class="text-center py-5">
                            <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                            <p class="text-muted">No goals found. Start by creating your first goal!</p>
                        </td>
                    </tr>
                }
                @foreach(var goal in Model)
                {
                    <tr>
                        <td>
                            <strong>@goal.Title</strong>
                        </td>
                        <td>
                            @if(goal.Type == GoalTrackerApp.Models.GoalType.ShortTerm)
                            {
                                <span class="type-shortterm">
                                    <i class="fas fa-clock"></i> Short Term
                                </span>
                            }
                            else
                            {
                                <span class="type-longterm">
                                    <i class="fas fa-hourglass-half"></i> Long Term
                                </span>
                            }
                        </td>
                        <td>
                            <div class="progress-container">
                                <div class="progress-bar-custom">
                                    <div class="progress-bar-fill" style="width: @goal.ProgressPercent%"></div>
                                </div>
                                <span class="progress-text">@goal.ProgressPercent%</span>
                                @if(goal.ProgressPercent == 100)
                                {
                                    <span class="badge bg-success ms-2">
                                        <i class="fas fa-check"></i> Done
                                    </span>
                                }
                            </div>
                        </td>
                        <td>
                            @if(goal.Status == GoalTrackerApp.Models.GoalStatus.Active)
                            {
                                <span class="status-active">
                                    <i class="fas fa-play-circle"></i> Active
                                </span>
                            }
                            else
                            {
                                <span class="status-completed">
                                    <i class="fas fa-check-circle"></i> Completed
                                </span>
                            }
                        </td>
                        <td>
                            @goal.TargetDate.ToString("MMM dd, yyyy")
                            @if(ViewData[$"alert_{goal.Id}"] != null)
                            {
                                <span class="badge bg-danger alert-expired ms-2">
                                    <i class="fas fa-exclamation-triangle"></i> Expired!
                                </span>
                            }
                        </td>
                        <td>
                            <div class="action-buttons">
                                <a href="/Goals/Edit/@goal.Id" class="btn btn-sm btn-warning">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                                <a href="/Goals/Details/@goal.Id" class="btn btn-sm btn-info">
                                    <i class="fas fa-eye"></i> View
                                </a>
                                <a href="/Goals/Delete/@goal.Id" class="btn btn-sm btn-danger">
                                    <i class="fas fa-trash"></i> Delete
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@if(Model.Count > 0)
{
    <div class="text-center mt-4">
        <p class="text-muted">
            <i class="fas fa-info-circle"></i> 
            Showing @Model.Count goal(s) | 
            <strong>@Model.Count(g => g.Status == GoalTrackerApp.Models.GoalStatus.Completed)</strong> completed
        </p>
    </div>
}
